<html>
  <body>
    <h1>DEMO: ALPR</h1>
    <p id="status">TensorFlow.JS is loading...</p>
    <p id="status1">OpenCV is loading...</p>
    <p>Input image</p>
    <img src="Images/14CE754.jpg" id="imgSource" alt="Smiley face" height="500" width="500">
    <canvas id="canvasOutput" ></canvas>
  </body>
  <script>
    function onTfJsReady(){
      document.getElementById('status').innerHTML = 'TensorFlow.JS is ready.';
    }
  </script>
  
  <script src="https://cdn.jsdelivr.net/gh/nicolaspanel/numjs@0.15.1/dist/numjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@0.13.0" onload="onTfJsReady();"> </script>
  <script>
  function onOpenCvReady() {
      document.getElementById('status1').innerHTML = 'OpenCV.JS is ready.';
    }
  </script>
  <script src="openCV-js-master/openCV-js-master/opencv.js" onload="onOpenCvReady();"  type="text/javascript"></script>
  <script>
    let image = tf.fromPixels(imgSource);
    //let dsize = new cv.Size(128, 64);
    //cv.cvtColor(image, image, cv.COLOR_BGR2GRAY, 0);
    //cv.resize(image, image, dsize);
    image = image.mean(2);
    image = tf.reshape(image, [128, 64]);
    image = nj.array(image);
    image = tf.tensor(image);
    image = tf.reshape(image, [64, 128]);
    image = tf.cast(image,'float32');
    image = tf.expandDims(image, -1);
    image = tf.expandDims(image, 0);
    
    async function predict(image){
      console.log("Model loading...");
      const model = await tf.loadModel("model4jszp/model.json");
      console.log("Model loaded.");
      out = model.predict(image);
    }
    out = predict(image);
  </script>

</html>
